{% extends "base.html" %}

{% block content %}
<div class="container-fluid main-container d-flex align-items-center justify-content-center">
    <div class="text-center">
        <h1 class="display-4 mb-4">Choose your constraints</h1>
        
        <form id="constraintsForm" method="POST" class="needs-validation" novalidate>
            <!-- Question 1 -->
            <div class="question-container" id="question1">
                <div class="mb-4">
                    <label for="max_price" class="form-label h4">What is maximum you want to pay?</label>
                    <input type="number" class="form-control form-control-lg mx-auto" id="max_price" name="max_price" 
                           min="5" step="0.01" required style="max-width: 200px;">
                    <div class="invalid-feedback">
                        Please enter a value greater than or equal to $5
                    </div>
                </div>
                <button type="button" class="btn btn-dark" onclick="showNextQuestion(2)">Next</button>
            </div>

            <!-- Question 2 -->
            <div class="question-container d-none" id="question2">
                <div class="mb-4">
                    <label for="priority" class="form-label h4">What's your biggest priority?</label>
                    <select class="form-select form-select-lg mx-auto" id="priority" name="priority" required style="max-width: 200px;">
                        <option value="" selected disabled>Choose priority...</option>
                        <option value="protein">Protein</option>
                        <option value="fats">Fats</option>
                        <option value="carbs">Carbs</option>
                        <option value="micronutrients">Micronutrients</option>
                    </select>
                </div>
                <button type="button" class="btn btn-dark" onclick="showNextQuestion(3)">Next</button>
            </div>

            <!-- Question 3 -->
            <div class="question-container d-none" id="question3">
                <div class="mb-4">
                    <label class="form-label h4">Choose how much variety you want</label>
                    <div class="variation-inputs">
                        <div class="mb-3">
                            <label for="meat_variation" class="form-label">Meat Variation</label>
                            <select class="form-select mx-auto" id="meat_variation" name="meat_variation" required style="max-width: 200px;">
                                <option value="" selected disabled>Choose...</option>
                                {% for i in range(0, 6) %}
                                <option value="{{ i }}">{{ i }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="starch_variation" class="form-label">Starch Variation</label>
                            <select class="form-select mx-auto" id="starch_variation" name="starch_variation" required style="max-width: 200px;">
                                <option value="" selected disabled>Choose...</option>
                                {% for i in range(0, 6) %}
                                <option value="{{ i }}">{{ i }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="vegetable_variation" class="form-label">Vegetables Variation</label>
                            <select class="form-select mx-auto" id="vegetable_variation" name="vegetable_variation" required style="max-width: 200px;">
                                <option value="" selected disabled>Choose...</option>
                                {% for i in range(0, 6) %}
                                <option value="{{ i }}">{{ i }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="seafood_variation" class="form-label">Sea food Variation</label>
                            <select class="form-select mx-auto" id="seafood_variation" name="seafood_variation" required style="max-width: 200px;">
                                <option value="" selected disabled>Choose...</option>
                                {% for i in range(0, 6) %}
                                <option value="{{ i }}">{{ i }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn btn-dark">Get Results</button>
            </div>
        </form>
    </div>
</div>

<script>
function showNextQuestion(questionNum) {
    // Validate current question before proceeding
    const currentQuestion = document.getElementById(`question${questionNum-1}`);
    const inputs = currentQuestion.querySelectorAll('input, select');
    let isValid = true;
    
    inputs.forEach(input => {
        if (!input.checkValidity()) {
            isValid = false;
            input.classList.add('is-invalid');
        }
    });

    if (!isValid) return;

    // Hide all questions
    document.querySelectorAll('.question-container').forEach(q => {
        q.classList.add('d-none');
    });
    
    // Show the next question
    document.getElementById(`question${questionNum}`).classList.remove('d-none');
}

// Form validation
(function () {
    'use strict'
    const forms = document.querySelectorAll('.needs-validation')
    Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
            if (!form.checkValidity()) {
                event.preventDefault()
                event.stopPropagation()
            }
            form.classList.add('was-validated')
        }, false)
    })
})()
</script>
{% endblock %} 